# 什么是小样本学习
## 小样本要解决的问题
人类非常擅长通过极少量的样本识别一个新物体，比如小孩子只需要书中的一些图片就可以认识什么是“斑马”，什么是“犀牛”。在人类的快速学习能力的启发下，研究人员希望机器学习模型在学习了一定类别的大量数据后，对于新的类别，只需要少量的样本就能快速学习，这就是 Few-shot Learning 要解决的问题。
## Meta Learning
Few-shot Learning 是 Meta Learning 在监督学习领域的应用。Meta Learning，又称为 learning to learn，在 meta training 阶段将数据集分解为不同的 meta task，去学习类别变化的情况下模型的泛化能力，在 meta testing 阶段，面对全新的类别，不需要变动已有的模型，就可以完成分类。
## 小样本训练过程
在训练阶段，会在训练集中随机抽取 C 个类别，每个类别 K 个样本（总共 C\*K 个数据），构建一个 meta-task，作为模型的支撑集（support set）输入；再从这 C 个类中剩余的数据中抽取一批（batch）样本作为模型的预测对象（batch set）。即要求模型从 C\*K 个数据中学会如何区分这 C 个类别，这样的任务被称为 C-way K-shot 问题。

训练过程中，每次训练（episode）都会采样得到不同 meta-task，所以总体来看，训练包含了不同的类别组合，这种机制使得模型学会不同 meta-task 中的共性部分，比如如何提取重要特征及比较样本相似性等，忘掉meta-task中具体的task 相关部分。通过这种学习机制学到的模型，在面对新的未见过的 meta-task 时，也能较好地进行分类。
# 参数化与非参数化
![非参数化](https://pic.imgdb.cn/item/66821d61d9c307b7e92904cc.png)

普通的最近邻算法，直接计算测试样本与各个类别的训练样本之间的距离，然后选择距离最近的K个样本，按照加权求和或投票法来决定测试样本所属的类别（KNN），该方法无需训练只需要保存所有训练样本的特征信息，属于**非参量化学习算法**。

![](https://pic.imgdb.cn/item/66821d9fd9c307b7e9295f0e.png)
普通的神经网络算法，需要通过训练更新网络中的各个权重参数，最终利用softmax函数计算训练样本属于各个类别的概率，属于**参量化学习算法**。而对于小样本或单样本分类任务，由于训练样本极少无法充分的优化网络权重参数，因此效果通常较差。

# 经典网络
## Prototypical Networks for Few-Shot Learning
- 作者采用一种简单的四级神经网络结构将输入的信息映射到高维的特征空间（度量空间），由于引入了ReLU激活函数因此该映射是非线性的，然后对于每一个类别，取其高维特征向量的均值作为原型（Prototype，可以理解为聚类中心）。
- 距离度量方式本文选用的是Bregman散度中的平方欧氏距离，这是因为Bregman散度具备一种优良的性质，对于一系列特征点，特征空间中与所有点之间的平均距离最近的点是该系列特征点的均值。正是由于该原因，作者可以直接利用每个类别特征向量的均值作为该类别对应的原型。
- 训练过程：
  - 对于每一个批次随机选择Nc个类别的样本，对于每个类别选择Ns个样本作为支持训练集（Support Set），用于计算原型。对于每个类别，除去作为支持训练集的样本，剩余的样本中选取NQ个样本作为测试点（Query Points）,用于计算与原型之间的距离并得到损失，更新网络的参数。
  
![](https://pic.imgdb.cn/item/66821e24d9c307b7e92a1bcf.png)


## Relation Network for Few-Shot Learning
![](https://pic.imgdb.cn/item/66821ebed9c307b7e92aea2f.png)
- 整个网络分成两个阶段，第一阶段是一个嵌入式模块（用于提取特征信息），第二阶段是一个相关性模块（用于输出两幅图之间的相似程度得分，从而判断两幅图像是否来自同一类别）
由预先定义的固定的相似性度量函数（Matching Network——余弦距离，Prototypical Network——平方欧氏距离），提出一种可学习的非线性相似性度量方式，用于实现小样本甚至one-shot学习任务

- 特别的是，在处理同一类别包含多幅图像的数据集的时候（如：5-shot），RN采用将支持集中同一类别的图像得到的特征向量采用逐像素相加的方式得到对应类别的特征向量，再与查询集图像进行级联和计算得分的操作。
![](https://pic.imgdb.cn/item/66821f16d9c307b7e92b6145.png)
